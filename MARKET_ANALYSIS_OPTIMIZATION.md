# å¸‚åœºåˆ†æžé€»è¾‘ä¼˜åŒ–è¯´æ˜Ž

## ðŸ“‹ ä¼˜åŒ–æ¦‚è¿°

å‚è€ƒ toogo é¡¹ç›®çš„å¤šæ—¶é—´å‘¨æœŸå¸‚åœºçŠ¶æ€åˆ†æžï¼Œç®€åŒ–å¹¶ä¼˜åŒ–äº† hotgo_v2 ä¸­çš„å¸‚åœºåˆ†æžé€»è¾‘ï¼Œä½¿å…¶æ›´åŠ æ¸…æ™°ã€é«˜æ•ˆã€‚

## ðŸŽ¯ ä¼˜åŒ–ç›®æ ‡

1. **ç®€åŒ–å¸‚åœºåˆ†æžé€»è¾‘** - å‚è€ƒ toogo é¡¹ç›®çš„ç®€æ´å®žçŽ°
2. **å¤šæ—¶é—´å‘¨æœŸåˆ†æž** - åˆ†æž5ä¸ªæ—¶é—´å‘¨æœŸï¼Œç»¼åˆåˆ¤æ–­å¸‚åœºçŠ¶æ€
3. **æ¸…æ™°çš„åˆ¤æ–­è§„åˆ™** - ä½¿ç”¨ç®€å•çš„è¶‹åŠ¿å¼ºåº¦å’Œæ³¢åŠ¨çŽ‡åˆ¤æ–­
4. **æé«˜å‡†ç¡®æ€§** - å¤šå‘¨æœŸç»¼åˆåˆ¤æ–­ï¼Œé¿å…å•ä¸€å‘¨æœŸè¯¯åˆ¤

## ðŸ”§ ä¼˜åŒ–å†…å®¹

### 1. å¤šæ—¶é—´å‘¨æœŸåˆ†æž

**åˆ†æžå‘¨æœŸ**ï¼š
- **1m**ï¼šæœ€è¿‘2åˆ†é’Ÿï¼Œ1åˆ†é’ŸKçº¿ï¼ˆæƒé‡10%ï¼‰
- **5m**ï¼šæœ€è¿‘15åˆ†é’Ÿï¼Œ5åˆ†é’ŸKçº¿ï¼ˆæƒé‡15%ï¼‰
- **15m**ï¼šæœ€è¿‘1å°æ—¶ï¼Œ15åˆ†é’ŸKçº¿ï¼ˆæƒé‡25%ï¼‰
- **30m**ï¼šæœ€è¿‘2å°æ—¶ï¼Œ30åˆ†é’ŸKçº¿ï¼ˆæƒé‡25%ï¼‰
- **1H**ï¼šæœ€è¿‘4å°æ—¶ï¼Œ1å°æ—¶Kçº¿ï¼ˆæƒé‡25%ï¼‰

**ç‰¹ç‚¹**ï¼š
- é•¿æœŸå‘¨æœŸæƒé‡æ›´é«˜ï¼Œç¡®ä¿åˆ¤æ–­æ›´ç¨³å®š
- çŸ­æœŸå‘¨æœŸç”¨äºŽæ•æ‰å³æ—¶å˜åŒ–
- ä¸­æœŸå‘¨æœŸç”¨äºŽå¹³è¡¡åˆ¤æ–­

### 2. è¶‹åŠ¿å¼ºåº¦è®¡ç®—ï¼ˆå‚è€ƒtoogoï¼‰

**è®¡ç®—å…¬å¼**ï¼š
```go
// 1. è®¡ç®—ä»·æ ¼å˜åŒ–ç™¾åˆ†æ¯”
priceChange = |(endPrice - startPrice) / startPrice|

// 2. è®¡ç®—è¶‹åŠ¿ä¸€è‡´æ€§ï¼ˆä¸Šæ¶¨Kçº¿å æ¯”ï¼‰
consistency = upCount / totalKlines

// 3. ç»¼åˆè¶‹åŠ¿å¼ºåº¦
trendStrength = priceChange Ã— consistency
```

**ç‰¹ç‚¹**ï¼š
- ç®€å•ç›´è§‚ï¼Œæ˜“äºŽç†è§£
- ç»¼åˆè€ƒè™‘ä»·æ ¼å˜åŒ–å’Œè¶‹åŠ¿ä¸€è‡´æ€§
- å€¼èŒƒå›´ï¼š0-1

### 3. æ³¢åŠ¨çŽ‡è®¡ç®—ï¼ˆå‚è€ƒtoogoï¼‰

**è®¡ç®—å…¬å¼**ï¼š
```go
// 1. è®¡ç®—æ”¶ç›ŠçŽ‡åºåˆ—
returns[i] = (price[i] - price[i-1]) / price[i-1]

// 2. è®¡ç®—æ ‡å‡†å·®
stdDev = sqrt(variance(returns))

// 3. è®¡ç®—æ—¶é—´èŒƒå›´å› å­
timeRangeFactor = sqrt(Kçº¿æ•°é‡)

// 4. è½¬æ¢ä¸ºç™¾åˆ†æ¯”
volatility = stdDev Ã— timeRangeFactor Ã— 100
```

**ç‰¹ç‚¹**ï¼š
- åŸºäºŽæ”¶ç›ŠçŽ‡çš„æ ‡å‡†å·®
- è€ƒè™‘æ—¶é—´èŒƒå›´å› å­ï¼Œæ›´å‡†ç¡®åæ˜ æ³¢åŠ¨çŽ‡
- ç»“æžœå•ä½ä¸ºç™¾åˆ†æ¯”

### 4. å•å‘¨æœŸå¸‚åœºçŠ¶æ€åˆ¤æ–­

**åˆ¤æ–­è§„åˆ™**ï¼š
```go
// ä¼˜å…ˆåˆ¤æ–­è¶‹åŠ¿å¸‚åœº
if trendStrength > 0.35 && volatility >= 0.2 && volatility <= 1.8 {
    return "trend"
}

// æ ¹æ®æ³¢åŠ¨çŽ‡åˆ¤æ–­
if volatility >= 1.2 {
    return "high_vol"
} else if volatility <= 0.2 {
    return "low_vol"
} else {
    return "volatile"
}
```

**é˜ˆå€¼é…ç½®**ï¼š
- **é«˜æ³¢åŠ¨é˜ˆå€¼**ï¼š1.2%
- **ä½Žæ³¢åŠ¨é˜ˆå€¼**ï¼š0.2%
- **è¶‹åŠ¿å¼ºåº¦é˜ˆå€¼**ï¼š0.35

### 5. å¤šå‘¨æœŸç»¼åˆåˆ¤æ–­

**ç»¼åˆé€»è¾‘**ï¼ˆä¼˜å…ˆçº§ä»Žé«˜åˆ°ä½Žï¼‰ï¼š

1. **è¶‹åŠ¿å¸‚åœº**ï¼š
   - 2ä¸ªä»¥ä¸Šå‘¨æœŸæ˜¾ç¤ºè¶‹åŠ¿
   - åŠ æƒå¾—åˆ† â‰¥ 0.4
   - é•¿æœŸå‘¨æœŸï¼ˆ15m/30m/1Hï¼‰è‡³å°‘1ä¸ªæ˜¾ç¤ºè¶‹åŠ¿

2. **é«˜æ³¢åŠ¨å¸‚åœº**ï¼š
   - 2ä¸ªä»¥ä¸Šå‘¨æœŸæ˜¾ç¤ºé«˜æ³¢åŠ¨
   - åŠ æƒå¾—åˆ† â‰¥ 0.3

3. **ä½Žæ³¢åŠ¨å¸‚åœº**ï¼š
   - 2ä¸ªä»¥ä¸Šå‘¨æœŸæ˜¾ç¤ºä½Žæ³¢åŠ¨
   - åŠ æƒå¾—åˆ† â‰¥ 0.3
   - é•¿æœŸå‘¨æœŸè‡³å°‘1ä¸ªæ˜¾ç¤ºä½Žæ³¢åŠ¨

4. **é•¿æœŸè¶‹åŠ¿ä¼˜å…ˆ**ï¼š
   - å¦‚æžœé•¿æœŸå‘¨æœŸï¼ˆ30m/1Hï¼‰æ˜¾ç¤ºè¶‹åŠ¿ï¼Œå³ä½¿çŸ­æœŸéœ‡è¡ï¼Œä¹Ÿåˆ¤å®šä¸ºè¶‹åŠ¿

5. **çŸ­æœŸå¼‚å¸¸å¤„ç†**ï¼š
   - å¦‚æžœçŸ­æœŸé«˜æ³¢åŠ¨ä½†é•¿æœŸæ­£å¸¸ï¼Œåˆ¤å®šä¸ºéœ‡è¡å¸‚åœº

6. **é»˜è®¤**ï¼š
   - è¿”å›žåŠ æƒå¾—åˆ†æœ€é«˜çš„çŠ¶æ€

### 6. é£Žé™©åå¥½æ˜ å°„

**æ˜ å°„è§„åˆ™**ï¼š
- **trend** â†’ **balanced**ï¼ˆè¶‹åŠ¿å¸‚åœºï¼Œå¹³è¡¡ç­–ç•¥ï¼‰
- **volatile** â†’ **conservative**ï¼ˆéœ‡è¡å¸‚åœºï¼Œä¿å®ˆç­–ç•¥ï¼‰
- **high_vol** â†’ **conservative**ï¼ˆé«˜æ³¢åŠ¨ï¼Œä¿å®ˆç­–ç•¥ï¼‰
- **low_vol** â†’ **balanced**ï¼ˆä½Žæ³¢åŠ¨ï¼Œå¹³è¡¡ç­–ç•¥ï¼‰

**å¤šå‘¨æœŸç»¼åˆ**ï¼š
- å¦‚æžœå¤šä¸ªå‘¨æœŸéƒ½æŽ¨èä¿å®ˆåž‹ï¼Œä¸”é•¿æœŸå‘¨æœŸä¹ŸæŽ¨èä¿å®ˆåž‹ï¼Œåˆ¤å®šä¸ºä¿å®ˆåž‹
- å¦‚æžœå¤šä¸ªå‘¨æœŸéƒ½æŽ¨èæ¿€è¿›åž‹ï¼Œä¸”é•¿æœŸå‘¨æœŸä¹ŸæŽ¨èæ¿€è¿›åž‹ï¼Œåˆ¤å®šä¸ºæ¿€è¿›åž‹
- é»˜è®¤è¿”å›žåŠ æƒå¾—åˆ†æœ€é«˜çš„é£Žé™©åå¥½

## ðŸ“Š å¯¹æ¯”ä¼˜åŒ–å‰åŽ

### ä¼˜åŒ–å‰
- âŒ å¤æ‚çš„å¸‚åœºåˆ†æžé€»è¾‘
- âŒ å•ä¸€æ—¶é—´å‘¨æœŸåˆ†æž
- âŒ å¤æ‚çš„æŒ‡æ ‡è®¡ç®—ï¼ˆEMAã€MACDã€ATRç­‰ï¼‰
- âŒ éš¾ä»¥ç»´æŠ¤å’Œæ‰©å±•

### ä¼˜åŒ–åŽ
- âœ… ç®€æ´æ¸…æ™°çš„å¤šæ—¶é—´å‘¨æœŸåˆ†æž
- âœ… 5ä¸ªæ—¶é—´å‘¨æœŸç»¼åˆåˆ†æž
- âœ… ç®€å•çš„è¶‹åŠ¿å¼ºåº¦å’Œæ³¢åŠ¨çŽ‡è®¡ç®—
- âœ… æ˜“äºŽç†è§£å’Œç»´æŠ¤
- âœ… å‚è€ƒ toogo é¡¹ç›®æˆç†Ÿå®žçŽ°

## ðŸ” å…³é”®å‡½æ•°

### æ–°å¢žå‡½æ•°

1. **`analyzeMultiPeriodMarket()`** - å¤šæ—¶é—´å‘¨æœŸåˆ†æž
2. **`calculateTrendStrength()`** - è®¡ç®—è¶‹åŠ¿å¼ºåº¦
3. **`calculateVolatilityForTimeRange()`** - è®¡ç®—æ³¢åŠ¨çŽ‡
4. **`determinePeriodMarketState()`** - åˆ¤æ–­å•å‘¨æœŸå¸‚åœºçŠ¶æ€
5. **`determinePeriodRiskPreference()`** - åˆ¤æ–­å•å‘¨æœŸé£Žé™©åå¥½
6. **`synthesizeMarketState()`** - ç»¼åˆå¤šå‘¨æœŸå¸‚åœºçŠ¶æ€
7. **`synthesizeRiskPreference()`** - ç»¼åˆå¤šå‘¨æœŸé£Žé™©åå¥½

### ä¼˜åŒ–å‡½æ•°

1. **`analyzeMarket()`** - ä½¿ç”¨æ–°çš„å¤šæ—¶é—´å‘¨æœŸåˆ†æžé€»è¾‘

## ðŸ“ ä½¿ç”¨è¯´æ˜Ž

### è‡ªåŠ¨å¸‚åœºçŠ¶æ€åˆ†æž

æœºå™¨äººé…ç½®ï¼š
- `auto_market_state = 1` - å¯ç”¨è‡ªåŠ¨å¸‚åœºçŠ¶æ€åˆ†æž
- `auto_risk_preference = 1` - å¯ç”¨è‡ªåŠ¨é£Žé™©åå¥½åˆ†æž

ç³»ç»Ÿä¼šè‡ªåŠ¨ï¼š
1. åˆ†æž5ä¸ªæ—¶é—´å‘¨æœŸçš„å¸‚åœºçŠ¶æ€
2. ç»¼åˆåˆ¤æ–­æœ€ç»ˆå¸‚åœºçŠ¶æ€
3. æ ¹æ®å¸‚åœºçŠ¶æ€æ˜ å°„é£Žé™©åå¥½
4. ä»Žç­–ç•¥æ¨¡æ¿èŽ·å–å¯¹åº”çš„ç­–ç•¥é…ç½®

### æ‰‹åŠ¨é…ç½®

å¦‚æžœä¸æƒ³ä½¿ç”¨è‡ªåŠ¨åˆ†æžï¼š
- `auto_market_state = 0` - æ‰‹åŠ¨è®¾ç½®å¸‚åœºçŠ¶æ€
- `auto_risk_preference = 0` - æ‰‹åŠ¨è®¾ç½®é£Žé™©åå¥½

## ðŸŽ¯ ä¼˜åŠ¿

1. **æ›´å‡†ç¡®**ï¼šå¤šæ—¶é—´å‘¨æœŸç»¼åˆåˆ†æžï¼Œé¿å…å•ä¸€å‘¨æœŸè¯¯åˆ¤
2. **æ›´ç¨³å®š**ï¼šé•¿æœŸå‘¨æœŸæƒé‡æ›´é«˜ï¼Œåˆ¤æ–­æ›´ç¨³å®š
3. **æ›´ç®€æ´**ï¼šå‚è€ƒ toogo é¡¹ç›®æˆç†Ÿå®žçŽ°ï¼Œä»£ç ç®€æ´æ¸…æ™°
4. **æ›´æ˜“ç»´æŠ¤**ï¼šé€»è¾‘æ¸…æ™°ï¼Œæ˜“äºŽç†è§£å’Œæ‰©å±•
5. **æ›´é«˜æ•ˆ**ï¼šå‡å°‘ä¸å¿…è¦çš„è®¡ç®—ï¼Œæé«˜æ€§èƒ½

## ðŸ“š å‚è€ƒ

- toogo é¡¹ç›®ï¼š`handlers/strategy_config_handlers.go`
- toogo é¡¹ç›®ï¼š`services/template_optimizer_service.go`

---

**ä¼˜åŒ–å®Œæˆæ—¶é—´**ï¼š2024å¹´  
**ä¼˜åŒ–ç‰ˆæœ¬**ï¼šv2.0  
**å‚è€ƒé¡¹ç›®**ï¼štoogo

