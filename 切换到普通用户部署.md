# 切换到普通用户部署指南

## 🔍 问题

部署脚本不允许使用root用户运行，需要使用普通用户 `toogo`。

## ✅ 解决方案

### 方法1：切换到普通用户（推荐）

#### 步骤1：切换到toogo用户

```bash
# 切换到toogo用户
su - toogo
# 输入密码: Singapore2027!@#

# 或者使用sudo切换
sudo su - toogo
```

#### 步骤2：检查当前用户

```bash
whoami
# 应该显示: toogo
```

#### 步骤3：进入项目目录

```bash
cd /opt/toogo/toogo_v2
```

#### 步骤4：运行部署脚本

```bash
bash 部署脚本-新加坡服务器.sh
```

**注意：** 如果脚本在root目录，需要先复制到项目目录或使用完整路径。

### 方法2：使用sudo以普通用户身份运行

```bash
# 以toogo用户身份运行脚本
sudo -u toogo bash /root/部署脚本-新加坡服务器.sh

# 或如果脚本在项目目录
cd /opt/toogo/toogo_v2
sudo -u toogo bash 部署脚本-新加坡服务器.sh
```

---

## 🚀 完整操作步骤

### 1. 切换到toogo用户

```bash
su - toogo
# 输入密码: Singapore2027!@#
```

### 2. 检查项目目录权限

```bash
# 检查项目目录是否存在
ls -la /opt/toogo/toogo_v2

# 如果权限不足，需要root用户授权
# 退出toogo用户（输入exit），然后以root执行：
exit
sudo chown -R toogo:toogo /opt/toogo/toogo_v2
```

### 3. 复制部署脚本到项目目录（如果需要）

```bash
# 以root用户执行
cp /root/部署脚本-新加坡服务器.sh /opt/toogo/toogo_v2/
chown toogo:toogo /opt/toogo/toogo_v2/部署脚本-新加坡服务器.sh
chmod +x /opt/toogo/toogo_v2/部署脚本-新加坡服务器.sh
```

### 4. 切换到toogo用户并运行脚本

```bash
su - toogo
cd /opt/toogo/toogo_v2
bash 部署脚本-新加坡服务器.sh
```

---

## 📋 快速命令序列

```bash
# 1. 确保项目目录权限正确（root用户执行）
sudo chown -R toogo:toogo /opt/toogo/toogo_v2

# 2. 复制部署脚本（root用户执行）
cp /root/部署脚本-新加坡服务器.sh /opt/toogo/toogo_v2/
chown toogo:toogo /opt/toogo/toogo_v2/部署脚本-新加坡服务器.sh

# 3. 切换到toogo用户
su - toogo
# 密码: Singapore2027!@#

# 4. 进入项目目录
cd /opt/toogo/toogo_v2

# 5. 运行部署脚本
bash 部署脚本-新加坡服务器.sh
```

---

## 🔧 如果脚本需要sudo权限

脚本中需要sudo的操作会自动提示输入密码。确保toogo用户在sudo组中：

```bash
# 以root用户检查
groups toogo

# 如果不在sudo组，添加（root用户执行）
usermod -aG sudo toogo

# 验证
su - toogo
sudo whoami
# 应该显示: root
```

---

## ⚠️ 注意事项

1. **项目目录权限**
   - 确保toogo用户有读写权限
   - 如果权限不足，root用户需要授权

2. **脚本位置**
   - 脚本需要在toogo用户可以访问的位置
   - 建议复制到项目目录

3. **sudo权限**
   - toogo用户需要在sudo组中
   - 脚本中的sudo操作会自动提示密码

---

## 🎯 推荐操作流程

```bash
# === 在root用户下执行 ===

# 1. 确保项目目录权限
chown -R toogo:toogo /opt/toogo/toogo_v2

# 2. 复制部署脚本到项目目录
cp /root/部署脚本-新加坡服务器.sh /opt/toogo/toogo_v2/
chown toogo:toogo /opt/toogo/toogo_v2/部署脚本-新加坡服务器.sh
chmod +x /opt/toogo/toogo_v2/部署脚本-新加坡服务器.sh

# 3. 确保toogo用户在sudo组
usermod -aG sudo toogo

# === 切换到toogo用户 ===

# 4. 切换到toogo用户
su - toogo
# 密码: Singapore2027!@#

# 5. 进入项目目录
cd /opt/toogo/toogo_v2

# 6. 运行部署脚本
bash 部署脚本-新加坡服务器.sh
```

---

**按照这些步骤操作，就可以成功部署了！** 🎉
