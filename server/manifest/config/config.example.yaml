# ==========================================
# HotGo/Toogo 鐢熶骇鐜閰嶇疆绀轰緥
# 澶嶅埗姝ゆ枃浠朵负 config.yaml 骞朵慨鏀归厤缃?
# ==========================================

# hotgo绯荤粺閰嶇疆
system:
  appName: "hotgo"
  # 鈿狅笍 鐢熶骇鐜蹇呴』鍏抽棴debug
  debug: false
  # 鈿狅笍 鐢熶骇鐜浣跨敤product妯″紡
  mode: "product"
  ipMethod: "whois"
  isDemo: false
  isCluster: false
  log:
    switch: true
    queue: true
    module: [ "admin", "api", "default" ]
    skipCode: [ ]
  serveLog:
    switch: true
    queue: true
    levelFormat: [ "WARN", "ERRO", "FATA", "PANI" ]
  i18n:
    switch: true
    defaultLanguage: "zh-CN"
  addonsResourcePath: "resource"


# 缁熶竴榛樿鏃ュ織閰嶇疆
defaultLogger: &defaultLogger
  level: "warning"  # 鐢熶骇鐜鍙褰曡鍛婁互涓?
  flags: 42
  file: "{Y-m-d}.log"
  stdoutColorDisabled: true
  writerColorEnable: false
  rotateExpire: "30d"  # 鐢熶骇鐜淇濈暀30澶?
  rotateBackupLimit: 10
  rotateBackupCompress: 9


# gf閰嶇疆
server:
  address: ":8000"
  openapiPath: ""  # 鐢熶骇鐜鍏抽棴API鏂囨。
  swaggerPath: ""  # 鐢熶骇鐜鍏抽棴Swagger
  serverRoot: "resource/public"
  DumpRouterMap: false
  logPath: "logs/server"
  ErrorStack: false  # 鐢熶骇鐜涓嶈緭鍑哄爢鏍?
  ErrorLogEnabled: true
  errorLogPattern: "error/{Y-m-d}.log"
  accessLogEnabled: true
  accessLogPattern: "access/{Y-m-d}.log"
  maxHeaderBytes: "100KB"
  clientMaxBodySize: "200MB"
  serverAgent: "HG HTTP Server"
  pprofEnabled: false  # 鐢熶骇鐜鍏抽棴PProf
  logger:
    path: "logs/server"
    <<: *defaultLogger


# tcp鏈嶅姟
tcp:
  server:
    address: ":8099"
  client:
    cron:
      group: "cron"
      name: "cron1"
      address: "127.0.0.1:8099"
      appId: "1002"
      # 鈿狅笍 鐢熶骇鐜浣跨敤鐜鍙橀噺
      secretKey: "${TCP_CRON_SECRET_KEY:hotgo_cron_secret}"
    auth:
      group: "auth"
      name: "auth1"
      address: "127.0.0.1:8099"
      appId: "mengshuai"
      # 鈿狅笍 鐢熶骇鐜浣跨敤鐜鍙橀噺
      secretKey: "${TCP_AUTH_SECRET_KEY:hotgo_auth_secret}"


# 鏃ュ織閰嶇疆
logger:
  path: "logs/logger"
  <<: *defaultLogger
  cron:
    path: "logs/cron"
    <<: *defaultLogger
  queue:
    path: "logs/queue"
    <<: *defaultLogger
  tcpServer:
    path: "logs/tcpServer"
    <<: *defaultLogger
  tcpClient:
    path: "logs/tcpClient"
    <<: *defaultLogger


# Viewer閰嶇疆
viewer:
  paths: "resource/template"
  defaultFile: "index.html"
  delimiters: [ "@{", "}" ]
  homeLayout: "home/index.html"


# 鍐呭璁剧疆
setting:
  title: "Toogo.Ai"
  keywords: "閲忓寲浜ゆ槗,鑷姩浜ゆ槗鏈哄櫒浜?铏氭嫙璐у竵"
  description: "Toogo.Ai 鍏ㄨ嚜鍔ㄨ櫄鎷熻揣甯侀噺鍖栦氦鏄撳钩鍙?


# 璺敱閰嶇疆
router:
  admin:
    prefix: "/admin"
    exceptLogin: [
      "/sms/send",
      "/wechat/authorizeCall",
      "/site/logout",
    ]
    exceptAuth: [
      "/member/info",
      "/role/dynamic",
      "/notice/pullMessages",
      "/notice/readAll",
      "/notice/upRead",
      "/dictData/option",
      "/dictData/options",
      "/provinces/select",
      "/provinces/cityLabel",
      "/member/option",
    ]
  api:
    prefix: "/api"
    exceptLogin: [ ]
  websocket:
    prefix: "/socket"
    exceptLogin: [ ]
  home:
    prefix: "/home"
    exceptLogin: [ ]


# 缂撳瓨椹卞姩 - 鐢熶骇鐜寤鸿浣跨敤redis
cache:
  adapter: "redis"
  fileDir: "./storage/cache"


# 鐧诲綍浠ょ墝
token:
  # 鈿狅笍 鐢熶骇鐜蹇呴』淇敼榛樿瀵嗛挜锛佷娇鐢ㄧ幆澧冨彉閲?
  secretKey: "${TOKEN_SECRET_KEY:璇蜂慨鏀规榛樿瀵嗛挜}"
  expires: 604800
  autoRefresh: true
  refreshInterval: 86400
  maxRefreshTimes: 30
  multiLogin: false  # 鐢熶骇鐜寤鸿鍏抽棴澶氱鐧诲綍


# 娑堟伅闃熷垪 - 鐢熶骇鐜寤鸿浣跨敤redis
queue:
  switch: true
  driver: "redis"
  groupName: "toogo"
  disk:
    path: "./storage/diskqueue"
    batchSize: 100
    batchTime: 1
    segmentSize: 10485760
    segmentLimit: 3000
  redis:
    timeout: 0


# Redis閰嶇疆
redis:
  default:
    # 鈿狅笍 鐢熶骇鐜浣跨敤鐜鍙橀噺
    address: "${REDIS_ADDRESS:127.0.0.1:6379}"
    db: "2"
    pass: "${REDIS_PASSWORD:}"
    idleTimeout: "20"


# Database閰嶇疆
database:
  logger:
    path: "logs/database"
    <<: *defaultLogger
    stdout: false  # 鐢熶骇鐜涓嶈緭鍑哄埌缁堢
  default:
    # 鈿狅笍 鐢熶骇鐜浣跨敤鐜鍙橀噺锛岄潪root鐢ㄦ埛
    link: "${DATABASE_URL:pgsql:postgres:postgres@tcp(127.0.0.1:5432)/hotgo}"
    debug: false  # 鐢熶骇鐜鍏抽棴SQL璋冭瘯
    Prefix: "hg_"


# 閾捐矾杩借釜
jaeger:
  switch: false
  endpoint: "127.0.0.1:6831"


# 鐢熸垚浠ｇ爜 - 鐢熶骇鐜闄愬埗IP
hggen:
  allowedIPs: [ "127.0.0.1" ]  # 鍙厑璁告湰鍦拌闂?
  selectDbs: [ "default" ]
  disableTables: [ "hg_sys_gen_codes","hg_admin_role_casbin" ]
  delimiters: [ "@{", "}" ]
  application:
    crud:
      templates:
        - group: "default"
          isAddon: false
          masterPackage: "sys"
          templatePath: "./resource/generate/default/curd"
          apiPath: "./api/admin"
          controllerPath: "./internal/controller/admin/sys"
          logicPath: "./internal/logic/sys"
          inputPath: "./internal/model/input/sysin"
          routerPath: "./internal/router/genrouter"
          sqlPath: "./storage/data/generate"
          webApiPath: "../web/src/api"
          webViewsPath: "../web/src/views"
        - group: "addon"
          isAddon: true
          masterPackage: "sys"
          templatePath: "./resource/generate/default/curd"
          apiPath: "./addons/{$name}/api/admin"
          controllerPath: "./addons/{$name}/controller/admin/sys"
          logicPath: "./addons/{$name}/logic/sys"
          inputPath: "./addons/{$name}/model/input/sysin"
          routerPath: "./addons/{$name}/router/genrouter"
          sqlPath: "./storage/data/generate/addons"
          webApiPath: "../web/src/api/addons/{$name}"
          webViewsPath: "../web/src/views/addons/{$name}"
    queue:
      templates:
        - group: "default"
          templatePath: "./resource/generate/default/queue"
    cron:
      templates:
        - group: "default"
          templatePath: "./resource/generate/default/cron"
  addon:
    srcPath: "./resource/generate/default/addon"
    webApiPath: "../web/src/api/addons/{$name}"
    webViewsPath: "../web/src/views/addons/{$name}"


# ===========================================
# Toogo浜ゆ槗鎵€閰嶇疆
# ===========================================
exchange:
  proxy:
    # 鈿狅笍 鐢熶骇鐜鏍规嵁瀹為檯鎯呭喌閰嶇疆
    enabled: "${PROXY_ENABLED:false}"
    type: "${PROXY_TYPE:socks5}"
    host: "${PROXY_HOST:127.0.0.1}"
    port: "${PROXY_PORT:10808}"
  # API璇锋眰闄愭祦閰嶇疆
  rateLimit:
    enabled: true
    requestsPerSecond: 10  # 姣忕鏈€澶ц姹傛暟
    burst: 20              # 绐佸彂璇锋眰鏁?
  # 閲嶈瘯閰嶇疆
  retry:
    maxRetries: 3          # 鏈€澶ч噸璇曟鏁?
    baseDelay: 100         # 鍩虹寤惰繜(ms)
    maxDelay: 5000         # 鏈€澶у欢杩?ms)


# Toogo绯荤粺閰嶇疆
toogo:
  powerConsumePercent: 10
  inviteRewardPower: 30
  withdrawMinAmount: 10
  withdrawFeeRate: 0.02
  # 鏈哄櫒浜哄紩鎿庨厤缃?
  engine:
    maxRobotsPerUser: 10       # 姣忕敤鎴锋渶澶ф満鍣ㄤ汉鏁?
    priceWindowMaxSize: 1000   # 浠锋牸绐楀彛鏈€澶ф暟鎹偣
    signalHistoryMaxSize: 100  # 淇″彿鍘嗗彶鏈€澶ф潯鏁?

