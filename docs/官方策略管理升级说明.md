# 官方策略管理升级说明

## 📋 升级内容

### 1️⃣ 菜单名称修改

**路径**: 量化管理 → 策略模板

**修改为**: 量化管理 → 官方策略管理

**文件**: `web/src/router/modules/toogo.ts`

```typescript
{
  path: 'strategy',
  name: 'ToogoAdminStrategy',
  component: () => import('@/views/toogo/admin/strategy/index.vue'),
  meta: {
    title: '官方策略管理',  // 原：策略模板
    icon: renderIcon(PartitionOutlined),
  },
},
```

---

### 2️⃣ 页面功能调整

**文件**: `web/src/views/toogo/admin/strategy/index.vue`

#### 修改内容

1. **页面标题**
   - 原：`策略模板管理`
   - 改为：`官方策略管理`

2. **按钮文字**
   - 原：`新增策略`
   - 改为：`新增官方策略`

3. **弹窗标题**
   - 原：`新增策略` / `编辑策略`
   - 改为：`新增官方策略` / `编辑官方策略`

4. **添加说明提示**
   ```vue
   <n-alert type="info" style="margin-bottom: 16px" :bordered="false">
     <template #header>
       <n-space align="center">
         <n-icon size="18">🔥</n-icon>
         <span>官方策略管理说明</span>
       </n-space>
     </template>
     此页面用于创建和维护官方策略模板。官方策略会在"策略管理-官方策略模板"中展示，供所有用户添加使用。
   </n-alert>
   ```

5. **移除删除限制**
   - 原：官方策略禁止删除 (`disabled: row.isOfficial === 1`)
   - 改为：允许删除（管理员可以维护官方策略）

6. **强制官方标识**
   - 新增策略时，`isOfficial` 默认为 `1`
   - 编辑策略时，确保保持 `isOfficial = 1`

---

## 🎯 功能定位

### 原来的设计
- 混合管理官方和自定义策略模板
- 官方策略不可删除
- 用途不明确

### 升级后的设计
- **专门管理官方策略**
- 官方策略可以完全维护（增删改查）
- 明确用途：为所有用户提供标准策略模板

---

## 📊 数据流程

```
┌─────────────────────────────────────────────────────┐
│           量化管理 - 官方策略管理                      │
│  (管理员专用，创建和维护官方策略模板)                  │
└────────────────┬────────────────────────────────────┘
                 │
                 │ 创建/编辑/删除
                 │ isOfficial = 1
                 ↓
        ┌────────────────────┐
        │ 官方策略模板数据库   │
        │ hg_trading_strategy │
        │    _template        │
        └────────┬───────────┘
                 │
                 │ 展示
                 ↓
┌────────────────────────────────────────────────────┐
│        策略管理 - 官方策略模板                       │
│  (普通用户，浏览和添加官方策略到"我的策略")           │
└────────────────────────────────────────────────────┘
                 │
                 │ 复制添加
                 ↓
┌────────────────────────────────────────────────────┐
│        策略管理 - 我的策略模板                       │
│  (用户个人策略，可以自定义修改)                      │
└────────────────────────────────────────────────────┘
```

---

## 🔐 权限说明

### 官方策略管理（量化管理菜单下）
- ✅ 仅管理员可访问
- ✅ 可以创建官方策略
- ✅ 可以编辑官方策略
- ✅ 可以删除官方策略
- ✅ 所有操作的策略 `isOfficial = 1`

### 官方策略模板（策略管理菜单下）
- ✅ 所有用户可访问
- ✅ 只能浏览官方策略
- ✅ 可以添加到"我的策略"
- ❌ 不能修改或删除官方策略

### 我的策略模板（策略管理菜单下）
- ✅ 所有用户可访问
- ✅ 可以创建自己的策略
- ✅ 可以编辑自己的策略
- ✅ 可以删除自己的策略
- ✅ 所有操作的策略 `isOfficial = 0`

---

## 📝 使用场景

### 场景1：管理员创建新的官方策略

1. 进入 **量化管理 → 官方策略管理**
2. 点击 **新增官方策略**
3. 填写策略参数：
   - 策略标识：`v5_balanced_trend`
   - 策略名称：`⚖️ 平衡-趋势跟踪`
   - 风险偏好：`balanced`
   - 市场状态：`trend`
   - 杠杆范围：`5-10x`
   - 止损：`5%`
   - 等等...
4. 点击 **保存**
5. ✅ 官方策略创建成功，所有用户可见

### 场景2：管理员更新官方策略参数

1. 进入 **量化管理 → 官方策略管理**
2. 找到需要更新的策略，点击 **编辑**
3. 修改参数（如调整杠杆范围、止损比例等）
4. 点击 **保存**
5. ✅ 官方策略更新成功

### 场景3：管理员删除过时的官方策略

1. 进入 **量化管理 → 官方策略管理**
2. 找到需要删除的策略，点击 **删除**
3. 确认删除
4. ✅ 官方策略删除成功

### 场景4：用户使用官方策略

1. 进入 **策略管理 → 官方策略模板**
2. 浏览官方策略列表
3. 点击 **添加到我的策略**
4. ✅ 策略复制到用户的"我的策略"中
5. 用户可以在"我的策略"中自定义修改

---

## 🎨 界面对比

### 升级前
```
┌──────────────────────────────────┐
│  策略模板管理                     │
├──────────────────────────────────┤
│  [筛选] [新增策略]                │
├──────────────────────────────────┤
│  策略列表（官方+自定义混合）        │
│  - 官方策略（不可删除）            │
│  - 自定义策略（可删除）            │
└──────────────────────────────────┘
```

### 升级后
```
┌──────────────────────────────────┐
│  官方策略管理                     │
├──────────────────────────────────┤
│  ℹ️ 此页面用于创建和维护官方策略   │
│     模板，供所有用户使用           │
├──────────────────────────────────┤
│  [筛选] [新增官方策略]            │
├──────────────────────────────────┤
│  官方策略列表（全部可维护）        │
│  - 可编辑                         │
│  - 可删除                         │
└──────────────────────────────────┘
```

---

## ✅ 升级完成检查清单

- [x] 菜单名称修改为"官方策略管理"
- [x] 页面标题更新
- [x] 按钮文字更新
- [x] 添加功能说明提示
- [x] 移除官方策略删除限制
- [x] 强制新增策略为官方标识
- [x] 编辑时保持官方标识
- [x] 测试创建官方策略
- [x] 测试编辑官方策略
- [x] 测试删除官方策略

---

## 🚀 后续建议

1. **添加批量导入功能**
   - 支持从 SQL 文件导入官方策略
   - 支持从 JSON 配置导入

2. **添加版本管理**
   - 记录策略版本历史
   - 支持版本回滚

3. **添加策略测试功能**
   - 回测功能
   - 参数优化建议

4. **添加策略统计**
   - 使用次数统计
   - 收益率统计
   - 用户反馈

---

**升级完成时间**: 2025-12-03  
**升级人员**: AI Assistant  
**状态**: ✅ 完成

