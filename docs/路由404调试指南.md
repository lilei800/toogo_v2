# è·¯ç”±404è°ƒè¯•æŒ‡å—

## å½“å‰é—®é¢˜
è®¿é—® `/toogo/strategy/list` ä»ç„¶æ˜¾ç¤º404é”™è¯¯é¡µé¢

## è°ƒè¯•æ­¥éª¤

### 1. åœ¨æµè§ˆå™¨æ§åˆ¶å°æ£€æŸ¥è·¯ç”±æ˜¯å¦æ³¨å†Œ

æŒ‰ `F12` æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼Œåœ¨ Console æ ‡ç­¾æ‰§è¡Œï¼š

```javascript
// è·å–æ‰€æœ‰è·¯ç”±
const allRoutes = window.$router.getRoutes()

// æŸ¥æ‰¾ StrategyList è·¯ç”±
const strategyListRoute = allRoutes.find(r => r.name === 'StrategyList')
console.log('StrategyListè·¯ç”±:', strategyListRoute)

// å¦‚æœæ‰¾ä¸åˆ°ï¼ŒæŸ¥æ‰¾æ‰€æœ‰åŒ…å« 'strategy' çš„è·¯ç”±
const strategyRoutes = allRoutes.filter(r => 
  r.path.includes('strategy') || 
  r.name?.toString().includes('Strategy')
)
console.log('æ‰€æœ‰strategyç›¸å…³è·¯ç”±:', strategyRoutes)

// æŸ¥çœ‹æ€»è·¯ç”±æ•°
console.log('æ€»è·¯ç”±æ•°:', allRoutes.length)
```

**é¢„æœŸç»“æœ**:
- åº”è¯¥æ‰¾åˆ° `StrategyList` è·¯ç”±
- è·¯ç”±çš„ `path` åº”è¯¥æ˜¯ `/toogo/strategy/list`

**å¦‚æœæ‰¾ä¸åˆ°è·¯ç”±**: è¯´æ˜è·¯ç”±æ²¡æœ‰è¢«æ­£ç¡®æ³¨å†Œï¼Œå¯èƒ½æ˜¯ï¼š
- å‰ç«¯æœåŠ¡æ²¡æœ‰é‡å¯
- è·¯ç”±æ–‡ä»¶æœ‰è¯­æ³•é”™è¯¯
- è·¯ç”±è¢«è¿‡æ»¤æ‰äº†

---

### 2. æ£€æŸ¥å½“å‰è·¯ç”±ä¿¡æ¯

```javascript
// å½“å‰è·¯ç”±
console.log('å½“å‰è·¯ç”±:', window.$router.currentRoute.value)

// å½“å‰è·¯å¾„
console.log('å½“å‰è·¯å¾„:', window.$router.currentRoute.value.path)

// å½“å‰è·¯ç”±çš„metaä¿¡æ¯
console.log('è·¯ç”±meta:', window.$router.currentRoute.value.meta)
```

---

### 3. å°è¯•æ‰‹åŠ¨è·³è½¬

```javascript
// æ–¹æ³•1: ä½¿ç”¨è·¯ç”±åç§°
window.$router.push({ name: 'StrategyList', query: { groupId: 10 } })

// æ–¹æ³•2: ä½¿ç”¨è·¯å¾„
window.$router.push('/toogo/strategy/list?groupId=10')

// æ–¹æ³•3: ä½¿ç”¨å®Œæ•´URL
window.location.href = '/#/toogo/strategy/list?groupId=10'
```

---

### 4. æ£€æŸ¥è·¯ç”±å®ˆå«æ—¥å¿—

åœ¨ `web/src/router/guard/index.ts` çš„ `beforeEach` ä¸­æ·»åŠ æ—¥å¿—ï¼š

```typescript
router.beforeEach(async (to, from, next) => {
  console.log('ğŸ” è·¯ç”±å®ˆå«:', {
    to: to.path,
    from: from.path,
    name: to.name,
    meta: to.meta
  })
  
  // ... åŸæœ‰ä»£ç  ...
})
```

---

### 5. æ£€æŸ¥ç»„ä»¶æ˜¯å¦åŠ è½½æˆåŠŸ

```javascript
// å°è¯•ç›´æ¥å¯¼å…¥ç»„ä»¶
import('@/views/toogo/strategy/list.vue')
  .then(module => console.log('âœ… ç»„ä»¶åŠ è½½æˆåŠŸ', module))
  .catch(err => console.error('âŒ ç»„ä»¶åŠ è½½å¤±è´¥', err))
```

---

## å¯èƒ½çš„åŸå› å’Œè§£å†³æ–¹æ¡ˆ

### åŸå› 1: å‰ç«¯æœåŠ¡æ²¡æœ‰é‡å¯

**ç—‡çŠ¶**: ä¿®æ”¹äº†è·¯ç”±é…ç½®ï¼Œä½†è·¯ç”±åˆ—è¡¨ä¸­æ‰¾ä¸åˆ°æ–°è·¯ç”±

**è§£å†³**:
```bash
# åœæ­¢å‰ç«¯æœåŠ¡ (Ctrl + C)
# æ¸…é™¤ç¼“å­˜
rm -rf node_modules/.vite

# é‡æ–°å¯åŠ¨
npm run dev
```

---

### åŸå› 2: è·¯ç”±é…ç½®è¯­æ³•é”™è¯¯

**ç—‡çŠ¶**: æ•´ä¸ªè·¯ç”±æ¨¡å—æ²¡æœ‰åŠ è½½

**è§£å†³**: æ£€æŸ¥ `toogo.ts` æ–‡ä»¶æ˜¯å¦æœ‰è¯­æ³•é”™è¯¯

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
cd web
npx eslint src/router/modules/toogo.ts
```

---

### åŸå› 3: è·¯ç”±è¢«è¿‡æ»¤æ‰

**ç—‡çŠ¶**: å¼€å‘ç¯å¢ƒèƒ½è®¿é—®ï¼Œç”Ÿäº§ç¯å¢ƒä¸èƒ½

**è§£å†³**: æ£€æŸ¥ `asyncRoute.ts` ä¸­çš„è·¯ç”±è¿‡æ»¤é€»è¾‘

```typescript
// å¯èƒ½çš„è¿‡æ»¤ä»£ç 
if (route.meta?.permissions && route.meta.permissions.length > 0) {
  // æ£€æŸ¥æƒé™
}
```

---

### åŸå› 4: åŠ¨æ€è·¯ç”±æœªç”Ÿæˆ

**ç—‡çŠ¶**: åˆ·æ–°é¡µé¢åæ‰èƒ½è®¿é—®

**è§£å†³**: ç¡®ä¿è·¯ç”±å®ˆå«ä¸­æ­£ç¡®æ·»åŠ äº†åŠ¨æ€è·¯ç”±

```typescript
// web/src/router/guard/index.ts
const routes = await asyncRouteStore.generateRoutes(userInfo)
routes.forEach((item) => {
  router.addRoute(item as unknown as RouteRecordRaw)
})
```

---

### åŸå› 5: è·¯ç”±è·¯å¾„ä¸åŒ¹é…

**ç—‡çŠ¶**: è®¿é—® `/toogo/strategy/list` ä½†å®é™…æ³¨å†Œçš„æ˜¯ `/toogo/strategy/list/`

**è§£å†³**: æ£€æŸ¥è·¯ç”±é…ç½®çš„path

```typescript
{
  path: 'list',  // âœ… æ­£ç¡®ï¼Œç›¸å¯¹è·¯å¾„
  // ä¸è¦å†™æˆ
  path: '/list', // âŒ é”™è¯¯ï¼Œä¼šåŒ¹é…æ ¹è·¯å¾„
  path: 'list/', // âš ï¸ å¯èƒ½æœ‰é—®é¢˜
}
```

---

## ä¸´æ—¶è§£å†³æ–¹æ¡ˆ

å¦‚æœä»¥ä¸Šéƒ½ä¸è¡Œï¼Œå¯ä»¥å°è¯•è¿™ä¸ªä¸´æ—¶æ–¹æ¡ˆï¼š

### æ–¹æ¡ˆA: åˆ›å»ºä¸€ä¸ªä¸­è½¬é¡µé¢

**æ–‡ä»¶**: `web/src/views/toogo/strategy/redirect.vue`

```vue
<template>
  <div>è·³è½¬ä¸­...</div>
</template>

<script setup>
import { onMounted } from 'vue'
import { useRoute, useRouter } from 'vue-router'

const route = useRoute()
const router = useRouter()

onMounted(() => {
  const groupId = route.query.groupId
  const groupName = route.query.groupName
  
  // ä½¿ç”¨window.locationå¼ºåˆ¶è·³è½¬
  window.location.hash = `#/toogo/strategy/list?groupId=${groupId}&groupName=${groupName}`
})
</script>
```

ç„¶ååœ¨å®˜æ–¹ç­–ç•¥ç®¡ç†é¡µé¢è·³è½¬åˆ°è¿™ä¸ªä¸­è½¬é¡µé¢ã€‚

---

### æ–¹æ¡ˆB: ä½¿ç”¨window.open

**æ–‡ä»¶**: `web/src/views/toogo/admin/strategy/index.vue`

```typescript
function viewStrategies(row: any) {
  const url = `/#/toogo/strategy/list?groupId=${row.id}&groupName=${encodeURIComponent(row.groupName)}`
  window.open(url, '_blank')  // æ–°çª—å£æ‰“å¼€
  // æˆ–è€…
  window.location.href = url  // å½“å‰çª—å£è·³è½¬
}
```

---

### æ–¹æ¡ˆC: ä½¿ç”¨router.resolve

```typescript
function viewStrategies(row: any) {
  const resolved = router.resolve({
    path: '/toogo/strategy/list',
    query: { groupId: row.id, groupName: row.groupName }
  })
  
  console.log('è§£æç»“æœ:', resolved)
  
  if (resolved.name === 'notFound') {
    message.error('è·¯ç”±ä¸å­˜åœ¨ï¼Œè¯·é‡å¯å‰ç«¯æœåŠ¡')
  } else {
    window.location.href = resolved.href
  }
}
```

---

## å®Œæ•´æ£€æŸ¥æ¸…å•

- [ ] å‰ç«¯æœåŠ¡å·²é‡å¯
- [ ] æµè§ˆå™¨ç¼“å­˜å·²æ¸…é™¤ (Ctrl + Shift + R)
- [ ] åœ¨æ§åˆ¶å°æ‰§è¡Œè·¯ç”±æ£€æŸ¥ï¼Œç¡®è®¤è·¯ç”±å·²æ³¨å†Œ
- [ ] æ£€æŸ¥ Network æ ‡ç­¾ï¼Œçœ‹æ˜¯å¦æœ‰èµ„æºåŠ è½½å¤±è´¥
- [ ] æ£€æŸ¥ Console æ ‡ç­¾ï¼Œçœ‹æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯
- [ ] å°è¯•ç›´æ¥åœ¨åœ°å€æ è¾“å…¥ `/#/toogo/strategy/list?groupId=1`
- [ ] æ£€æŸ¥æ˜¯å¦å·²ç™»å½•
- [ ] æ£€æŸ¥ç”¨æˆ·æƒé™æ˜¯å¦è¶³å¤Ÿ
- [ ] é‡æ–°ç™»å½•è¯•è¯•

---

## æœ€ç»ˆå¤§æ‹›ï¼šå®Œå…¨é‡å»º

å¦‚æœä»¥ä¸Šéƒ½ä¸è¡Œï¼š

```bash
# 1. åœæ­¢æ‰€æœ‰æœåŠ¡
# 2. åˆ é™¤ç¼“å­˜
cd D:\go\src\hotgo_v2\web
rm -rf node_modules
rm -rf dist
rm -rf node_modules/.vite

# 3. é‡æ–°å®‰è£…ä¾èµ–
npm install

# 4. é‡å¯å¼€å‘æœåŠ¡å™¨
npm run dev

# 5. æ¸…é™¤æµè§ˆå™¨æ‰€æœ‰ç¼“å­˜
# F12 â†’ Application â†’ Clear storage â†’ Clear site data

# 6. é‡æ–°ç™»å½•
```

---

**åˆ›å»ºæ—¶é—´**: 2025-12-03  
**ä¼˜å…ˆçº§**: ğŸ”¥ ç´§æ€¥

















