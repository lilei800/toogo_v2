:root {
    --primary-color: #00f3ff;
    --secondary-color: #e0e0e0;
    --bg-color: #1a1a2e;
    --panel-bg: #16213e;
    --text-color: #fff;
    --heart-color: #ff0055;
    --sad-color: #4a69bd;
    --excited-color: #f6b93b;
}

body {
    margin: 0;
    padding: 0;
    background-color: var(--bg-color);
    color: var(--text-color);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
}

.container {
    text-align: center;
    width: 100%;
    max-width: 600px;
}

header h1 {
    margin: 0;
    font-size: 2.5rem;
    text-transform: uppercase;
    letter-spacing: 2px;
    color: var(--primary-color);
    text-shadow: 0 0 10px rgba(0, 243, 255, 0.5);
}

.scene {
    position: relative;
    height: 400px;
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 20px 0;
    background: radial-gradient(circle at center, #2a2a4e 0%, var(--bg-color) 70%);
    border-radius: 20px;
    overflow: hidden;
    perspective: 1000px; /* 为3D效果做准备 */
}

/* --- 动态科技背景 --- */
.tech-background {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 0;
    overflow: hidden;
    opacity: 0.3;
}

.tech-background::before {
    content: '';
    position: absolute;
    width: 200%;
    height: 200%;
    top: -50%;
    left: -50%;
    background-image: 
        linear-gradient(rgba(0, 243, 255, 0.1) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0, 243, 255, 0.1) 1px, transparent 1px);
    background-size: 40px 40px;
    transform: perspective(500px) rotateX(60deg);
    animation: grid-move 20s linear infinite;
}

@keyframes grid-move {
    0% { transform: perspective(500px) rotateX(60deg) translateY(0); }
    100% { transform: perspective(500px) rotateX(60deg) translateY(40px); }
}

/* --- 聊天气泡 --- */
.chat-bubble {
    position: absolute;
    top: 40px;
    right: 40px;
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(5px);
    border: 1px solid var(--primary-color);
    color: var(--primary-color);
    padding: 10px 20px;
    border-radius: 15px 15px 0 15px;
    font-size: 14px;
    z-index: 10;
    opacity: 0; /* 初始隐藏，由JS控制显示 */
    transform: translateY(0);
    box-shadow: 0 0 10px rgba(0, 243, 255, 0.2);
    max-width: 150px;
    min-height: 20px; /* 防止文字为空时塌陷 */
    display: flex;
    align-items: center;
}

/* 打字机光标效果 */
.chat-bubble::after {
    content: '|';
    animation: blink-cursor 1s infinite;
    margin-left: 2px;
    color: var(--primary-color);
}

@keyframes blink-cursor {
    0%, 100% { opacity: 1; }
    50% { opacity: 0; }
}

#toogo-robot {
    width: 300px;
    height: 300px;
    transition: all 0.5s ease;
    z-index: 1; /* 确保在背景之上 */
    cursor: pointer; /* 提示可点击 */
}

.shadow {
    transition: all 0.5s ease;
    transform-origin: center;
    opacity: 0.8;
}

/* --- 基础部件样式 --- */
.head-group {
    transform-origin: 200px 200px;
    transition: transform 0.5s ease;
}

.eyebrow {
    transition: all 0.3s ease;
    transform-origin: center;
}

.mouth {
    transition: opacity 0.3s ease;
}

.cheeks {
    transition: opacity 0.3s ease;
}

.tail-group {
    transform-origin: 280px 280px;
    transition: transform 0.5s ease;
}

.eye-ball {
    transition: all 0.3s ease;
}

.indicator-light {
    transition: fill 0.3s;
}

/* --- 默认动画 (Idle) --- */
@keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-5px); }
}

@keyframes blink {
    0%, 96%, 98% { transform: scaleY(1); }
    97% { transform: scaleY(0.1); }
}

#toogo-robot {
    animation: float 3s ease-in-out infinite;
}

.eyes {
    transform-origin: center;
}

.eye {
    animation: blink 4s infinite;
    transform-origin: center;
}

/* --- 心情状态: 开心 (Happy) --- */
.mood-happy #toogo-robot {
    animation: jump 0.8s infinite alternate;
}

.mood-happy .tail-group {
    animation: wag 0.5s infinite ease-in-out;
}

.mood-happy .eye-ball {
    display: none;
}

.mood-happy .eye-squint {
    display: block !important;
    transform: scale(1.2);
}

.mood-happy .mouth-smile {
    opacity: 1 !important;
}

.mood-happy .cheeks {
    opacity: 1 !important;
}

.mood-happy .eyebrow {
    transform: translateY(-5px);
}

.mood-happy .shadow {
    animation: shadow-jump 0.8s infinite alternate;
}

@keyframes jump {
    0% { transform: translateY(0); }
    100% { transform: translateY(-20px); }
}

@keyframes shadow-jump {
    0% { transform: scale(1); opacity: 0.8; }
    100% { transform: scale(0.6); opacity: 0.4; }
}

@keyframes wag {
    0% { transform: rotate(0deg); }
    25% { transform: rotate(15deg); }
    75% { transform: rotate(-15deg); }
    100% { transform: rotate(0deg); }
}

/* --- 心情状态: 思考 (Thinking) --- */
.mood-thinking .head-group {
    transform: rotate(15deg);
}

.mood-thinking .indicator-light {
    animation: flash-light 0.5s infinite;
    fill: #ff9f43;
}

.mood-thinking .eye-ball {
    transform: scale(1.2);
}

.mood-thinking .mouth-line {
    opacity: 1 !important;
}

.mood-thinking .left-eyebrow {
    transform: translateY(-3px) rotate(-10deg);
}

.mood-thinking .right-eyebrow {
    transform: translateY(3px) rotate(10deg);
}

@keyframes flash-light {
    0%, 100% { fill: #555; }
    50% { fill: #ff9f43; box-shadow: 0 0 10px #ff9f43; }
}

/* --- 心情状态: 疑惑 (Confused) --- */
.mood-confused .head-group {
    animation: shake-head 2s infinite ease-in-out;
}

.mood-confused .question-mark {
    opacity: 1 !important;
    animation: float-up 2s infinite;
}

.mood-confused .right-ear {
    transform: rotate(20deg) translate(10px, -10px);
}

.mood-confused .mouth-open {
    opacity: 1 !important;
    transform: scale(0.8);
}

.mood-confused .left-eyebrow {
    transform: translateY(-5px);
}

.mood-confused .right-eyebrow {
    transform: translateY(2px);
}

@keyframes shake-head {
    0%, 100% { transform: rotate(0deg); }
    25% { transform: rotate(-10deg); }
    75% { transform: rotate(10deg); }
}

@keyframes float-up {
    0% { transform: translate(280px, 100px); opacity: 0; }
    50% { opacity: 1; }
    100% { transform: translate(280px, 80px); opacity: 0; }
}

/* --- 心情状态: 疲惫 (Tired) --- */
.mood-tired #toogo-robot {
    animation: float 6s ease-in-out infinite; /* Slower float */
    filter: grayscale(0.5);
}

.mood-tired .eye {
    animation: sleepy-blink 3s infinite;
}

.mood-tired .head-group {
    transform: translateY(10px) rotate(-5deg);
}

.mood-tired .mouth-open {
    opacity: 1 !important;
    animation: yawn 3s infinite;
}

.mood-tired .eyebrow {
    transform: rotate(10deg) translateY(2px); /* 八字眉 */
}

@keyframes sleepy-blink {
    0%, 50%, 100% { transform: scaleY(0.3); } /* Half closed */
    25% { transform: scaleY(0.1); } /* Closed */
    75% { transform: scaleY(0.3); }
}

@keyframes yawn {
    0%, 100% { transform: scale(0.5); }
    50% { transform: scale(1.2); }
}

/* --- 心情状态: 兴奋 (Excited) --- */
.mood-excited #toogo-robot {
    animation: vibrate 0.2s infinite;
}

.mood-excited .face-screen {
    animation: rainbow-bg 1s infinite;
}

.mood-excited .tail-group {
    animation: wag 0.2s infinite;
}

.mood-excited .eye-ball {
    display: none;
}

.mood-excited .eye-heart {
    display: block !important;
    animation: pulse-heart 0.4s infinite alternate;
}

.mood-excited .mouth-smile {
    opacity: 1 !important;
    transform: scale(1.2);
}

.mood-excited .cheeks {
    opacity: 1 !important;
}

@keyframes vibrate {
    0% { transform: translate(0, 0); }
    25% { transform: translate(2px, 2px); }
    50% { transform: translate(-2px, -2px); }
    75% { transform: translate(2px, -2px); }
    100% { transform: translate(-2px, 2px); }
}

@keyframes rainbow-bg {
    0% { fill: #111; }
    25% { fill: #222; }
    50% { fill: #333; }
    75% { fill: #222; }
    100% { fill: #111; }
}

@keyframes pulse-heart {
    0% { transform: scale(1.5); }
    100% { transform: scale(1.8); }
}

/* --- 心情状态: 专注 (Focused) --- */
.mood-focused .data-stream {
    opacity: 1 !important;
    animation: spin-data 4s linear infinite;
}

.mood-focused .eye-ball {
    fill: #ff3333; /* Red focus */
    r: 8; /* Smaller pupil */
}

.mood-focused .head-group {
    transform: translateZ(0); /* Fix for sharpness if needed */
}

.mood-focused .mouth-line {
    opacity: 1 !important;
}

.mood-focused .eyebrow {
    transform: rotate(15deg) translateY(5px); /* 紧皱 */
}

@keyframes spin-data {
    0% { stroke-dashoffset: 0; }
    100% { stroke-dashoffset: 100; }
}

/* --- 心情状态: 失落 (Sad) --- */
.mood-sad .head-group {
    transform: translateY(20px) rotate(-10deg);
}

.mood-sad .tail-group {
    transform: rotate(40deg); /* Tail down */
}

.mood-sad .face-screen {
    fill: #0a0a15;
}

.mood-sad .eye-ball {
    fill: var(--sad-color);
}

.mood-sad #toogo-robot {
    transform: scale(0.95);
}

.mood-sad .mouth-sad {
    opacity: 1 !important;
}

.mood-sad .eyebrow {
    transform: rotate(-10deg) translateY(-2px); /* 悲伤眉 */
}

/* --- 交易状态: 保守型 (Conservative) --- */
.mood-conservative .shield-group {
    opacity: 1 !important;
    animation: shield-pulse 3s infinite ease-in-out;
}

.mood-conservative .eye-ball {
    fill: #4cd137; /* 绿色安全 */
}

.mood-conservative .mouth-line {
    opacity: 1 !important;
    stroke: #4cd137;
}

.mood-conservative .body-screen {
    fill: #1e272e; /* 深沉背景 */
}

.mood-conservative .eyebrow {
    stroke: #4cd137;
}

@keyframes shield-pulse {
    0%, 100% { opacity: 0.4; transform: scale(1); }
    50% { opacity: 0.7; transform: scale(1.02); }
}

/* --- 交易状态: 平衡型 (Balanced) --- */
.mood-balanced .head-group {
    animation: balance-head 4s infinite ease-in-out;
}

.mood-balanced .eye-ball {
    fill: #00a8ff; /* 蓝色冷静 */
}

.mood-balanced .chart-group {
    opacity: 1 !important;
}

.mood-balanced .chart-line {
    stroke: #00a8ff;
    animation: draw-chart 2s infinite alternate;
}

.mood-balanced .chart-dot {
    fill: #00a8ff;
}

.mood-balanced .mouth-smile {
    opacity: 1 !important;
    stroke: #00a8ff;
    transform: scale(0.8);
}

@keyframes balance-head {
    0%, 100% { transform: rotate(0deg); }
    25% { transform: rotate(5deg); }
    75% { transform: rotate(-5deg); }
}

@keyframes draw-chart {
    0% { stroke-dasharray: 0, 100; }
    100% { stroke-dasharray: 100, 0; }
}

/* --- 交易状态: 激进型 (Aggressive) --- */
.mood-aggressive #toogo-robot {
    animation: aggressive-shake 0.1s infinite;
    transform: translateY(-20px); /* 升空 */
}

.mood-aggressive .fire-group {
    opacity: 1 !important;
}

.mood-aggressive .flame {
    animation: fire-burn 0.1s infinite alternate;
}

.mood-aggressive .eye-ball {
    fill: #e84118; /* 红色激进 */
    filter: drop-shadow(0 0 8px #e84118);
}

.mood-aggressive .eyebrow {
    stroke: #e84118;
    transform: rotate(20deg) translateY(10px); /* 怒目/专注 */
}

.mood-aggressive .mouth-smile {
    opacity: 1 !important;
    stroke: #e84118;
    transform: scale(1.2); /* 自信大笑 */
}

.mood-aggressive .chart-group {
    opacity: 1 !important;
    transform: translate(280px, 150px) scale(1.5); /* 更大的图表 */
}

.mood-aggressive .chart-line {
    stroke: #e84118;
}

.mood-aggressive .chart-dot {
    fill: #e84118;
}

.mood-aggressive .shadow {
    transform: scale(0.6);
    opacity: 0.4;
    animation: shadow-shake 0.1s infinite;
}

@keyframes aggressive-shake {
    0% { transform: translate(0, -20px); }
    25% { transform: translate(1px, -19px); }
    50% { transform: translate(-1px, -21px); }
    75% { transform: translate(1px, -21px); }
    100% { transform: translate(-1px, -19px); }
}

@keyframes shadow-shake {
    0%, 100% { transform: scale(0.6) translate(0, 0); }
    50% { transform: scale(0.6) translate(1px, 0); }
}

@keyframes fire-burn {
    0% { transform: scaleY(1); opacity: 0.8; }
    100% { transform: scaleY(1.2); opacity: 1; }
}

/* --- 控制面板 --- */
.controls {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
    padding: 20px;
    background: var(--panel-bg);
    border-radius: 15px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
}

button {
    background: transparent;
    border: 1px solid var(--primary-color);
    color: var(--primary-color);
    padding: 10px;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s;
    font-weight: bold;
}

button:hover {
    background: var(--primary-color);
    color: #000;
    box-shadow: 0 0 10px var(--primary-color);
}

@media (max-width: 600px) {
    .controls {
        grid-template-columns: repeat(2, 1fr);
    }
}
