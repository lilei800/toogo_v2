# 数据库检查执行说明

## 执行步骤

### 方法1：直接在数据库中执行SQL（推荐）

1. **打开数据库管理工具**（如 Navicat、MySQL Workbench、phpMyAdmin 等）

2. **连接到数据库**（hotgo_v2）

3. **执行SQL脚本**：打开文件 `执行策略模板检查.sql`，执行所有查询

4. **查看结果**：重点关注查询2的结果，检查参数是否正确

### 方法2：通过命令行执行

```bash
# MySQL
mysql -u root -p hotgo_v2 < 执行策略模板检查.sql

# 或者逐条执行
mysql -u root -p hotgo_v2 -e "SELECT ..."
```

## 关键查询说明

### 查询2：检查 volatile + balanced 的策略模板（最重要）

这个查询会显示：
- 策略模板的所有参数
- **参数检查**列会显示 ✅ 或 ❌

**预期结果：**
- 杠杆: 10
- 保证金: 10.0
- 时间窗口: 60
- 波动值: 50.0
- 止损: 10.0
- 启动止盈: 5.0
- 止盈回撤: 10.0

**如果显示 ❌ 参数错误：**
说明数据库中的数据不正确，需要执行更新SQL（查询7）

## 如果发现数据错误

### 步骤1：备份数据
```sql
-- 备份策略模板表
CREATE TABLE hg_trading_strategy_template_backup_20250103 AS 
SELECT * FROM hg_trading_strategy_template;
```

### 步骤2：执行更新SQL
取消查询7的注释，执行更新语句

### 步骤3：验证更新
再次执行查询2，确认参数已更新

### 步骤4：重启机器人
更新数据后，需要重启机器人或调用重新加载策略配置接口

## 常见问题

### Q1: 查询2没有返回结果
**可能原因：**
- 策略组名称不匹配
- 市场状态不是 'volatile'（可能是 'range' 或其他值）
- 策略模板未激活（is_active = 0）

**解决方法：**
- 执行查询3，查看所有市场状态
- 执行查询5，确认策略组名称

### Q2: 查询到了多条记录
**可能原因：**
- 存在多个策略组
- 存在重复的策略模板

**解决方法：**
- 检查查询4，确认机器人使用的策略组ID
- 确认策略组ID是否正确

### Q3: 参数检查显示 ❌
**解决方法：**
- 执行查询7的更新SQL
- 确认更新条件正确（策略组名称、市场状态、风险偏好）

## 执行后请提供以下信息

1. **查询2的结果**（volatile + balanced 的策略模板）
2. **查询4的结果**（机器人的策略组ID配置）
3. **查询6的结果**（市场状态值分布）

这些信息将帮助我进一步分析问题。

